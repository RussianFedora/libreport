From 57eb0c7c569ef06831ea90777f89920c96ee33b9 Mon Sep 17 00:00:00 2001
From: Denys Vlasenko <dvlasenk@redhat.com>
Date: Fri, 30 Sep 2011 19:15:10 +0200
Subject: [PATCH 4/4] reporter-mailx: use Bugzilla's output format. Closes
 rhbz#717321.

Signed-off-by: Denys Vlasenko <dvlasenk@redhat.com>
---
 src/include/internal_libreport.h |    5 +++--
 src/lib/make_descr.c             |    2 ++
 src/plugins/reporter-mailx.c     |    3 ++-
 3 files changed, 7 insertions(+), 3 deletions(-)

diff --git a/src/include/internal_libreport.h b/src/include/internal_libreport.h
index afaf911..67a7ea3 100644
--- a/src/include/internal_libreport.h
+++ b/src/include/internal_libreport.h
@@ -548,8 +548,9 @@ char *make_description(problem_data_t *problem_data, char **names_to_skip, unsig
 char* make_description_bz(problem_data_t *problem_data);
 #define make_description_logger libreport_make_description_logger
 char* make_description_logger(problem_data_t *problem_data);
-#define make_description_mailx libreport_make_description_mailx
-char* make_description_mailx(problem_data_t *problem_data);
+//UNUSED
+//#define make_description_mailx libreport_make_description_mailx
+//char* make_description_mailx(problem_data_t *problem_data);
 
 #define parse_release_for_bz libreport_parse_release_for_bz
 void parse_release_for_bz(const char *pRelease, char **product, char **version);
diff --git a/src/lib/make_descr.c b/src/lib/make_descr.c
index 7034526..2a6a973 100644
--- a/src/lib/make_descr.c
+++ b/src/lib/make_descr.c
@@ -184,6 +184,7 @@ char *make_description(problem_data_t *problem_data, char **names_to_skip, unsig
     return strbuf_free_nobuf(buf_dsc);
 }
 
+#ifdef UNUSED
 char* make_description_mailx(problem_data_t *problem_data)
 {
     struct strbuf *buf_dsc = strbuf_new();
@@ -227,6 +228,7 @@ char* make_description_mailx(problem_data_t *problem_data)
 
     return strbuf_free_nobuf(buf_dsc);
 }
+#endif
 
 /* Items we don't want to include to bz / logger */
 static const char *const blacklisted_items[] = {
diff --git a/src/plugins/reporter-mailx.c b/src/plugins/reporter-mailx.c
index ae7f774..f7d9cde 100644
--- a/src/plugins/reporter-mailx.c
+++ b/src/plugins/reporter-mailx.c
@@ -75,7 +75,8 @@ static void create_and_send_email(
     unsigned arg_size = 0;
     args = append_str_to_vector(args, &arg_size, "/bin/mailx");
 
-    char *dsc = make_description_mailx(problem_data);
+    //char *dsc = make_description_mailx(problem_data);
+    char *dsc = make_description_bz(problem_data);
 
     if (send_binary_data)
     {
-- 
1.7.6.4

